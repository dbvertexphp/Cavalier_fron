<div class="max-w-6xl mx-auto p-6 bg-white rounded-xl shadow-lg border border-gray-100 overflow-y-auto max-h-[85vh]">
  <h2 class="text-2xl font-bold text-green-600 mb-6 border-b pb-4">
    {{ isBranchForm ? 'Cavalier Branch Registration' : 'Employee Details' }}
  </h2>

  <form [formGroup]="userForm" (ngSubmit)="onSubmit()" class="space-y-6 text-sm">

    <div *ngIf="isBranchForm" class="space-y-6">
      <div class="grid grid-cols-1 md:grid-cols-2 gap-4 bg-gray-50 p-4 rounded">
        <div><label class="font-bold">Company Name*</label> <input formControlName="companyName"
            class="w-full border p-2 rounded"></div>
        <div><label>Company Alias</label> <input formControlName="companyAlias" class="w-full border p-2 rounded"></div>
      </div>

      <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
        <div><label class="font-bold">Branch Name*</label> <input formControlName="branchName"
            class="w-full border p-2 rounded"></div>
        <div><label class="font-bold">Branch Code*</label> <input formControlName="branchCode"
            class="w-full border p-2 rounded uppercase"></div>
        <div><label class="font-bold">Email*</label> <input formControlName="email" class="w-full border p-2 rounded">
        </div>
      </div>

      <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
        <div><label>City*</label> <input formControlName="city" class="w-full border p-2 rounded"></div>
        <div><label>State*</label> <input formControlName="state" class="w-full border p-2 rounded"></div>
        <div><label>Postal Code*</label> <input formControlName="postalCode" class="w-full border p-2 rounded"></div>
        <div><label>Contact No*</label> <input formControlName="contactNo" class="w-full border p-2 rounded"></div>
      </div>

      <div class="grid grid-cols-1 md:grid-cols-2 gap-4 bg-blue-50/30 p-4 rounded">
        <div><label class="font-bold">GST Category*</label>
          <select formControlName="gstCategory" class="w-full border p-2 rounded">
            <option value="Regular">Regular</option>
            <option value="Composition">Composition</option>
          </select>
        </div>
        <div><label class="font-bold">GSTIN*</label> <input formControlName="gstin"
            class="w-full border p-2 rounded uppercase"></div>
      </div>

      <div><label>Full Address*</label> <textarea formControlName="address"
          class="w-full border p-2 rounded h-16"></textarea></div>
    </div>

    <div *ngIf="!isBranchForm" class="space-y-6">
      <div class="grid grid-cols-1 md:grid-cols-5 gap-4 bg-gray-50 p-4 rounded">
        <div >
    <label  class="font-bold" >User Type</label>
    <select formControlName="userType"
      class="w-full border p-2 rounded outline-none focus:border-[#4a3f3f] bg-white">
      <option value="" disabled selected>Select User Type</option>
      <option value="training">Training</option>
      <option value="payroll">Payroll</option>
      <option value="freelancing">Freelancing</option>
    </select>
  </div>
        <div><label class="font-bold">First Name*</label> <input formControlName="firstName"
            class="w-full border p-2 rounded"></div>
        <div><label>Middle Name</label> <input formControlName="middleName" class="w-full border p-2 rounded"></div>
        <div><label class="font-bold">Last Name*</label> <input formControlName="lastName"
            class="w-full border p-2 rounded"></div>
        <div><label class="font-bold">Email*</label> <input formControlName="email" class="w-full border p-2 rounded">
        </div>
      </div>

      <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
        <div><label>DOB*</label> <input type="date" formControlName="dob" class="w-full border p-2 rounded"></div>
        <div>
          <label>Gender</label>
          <select formControlName="gender" class="w-full border p-2 rounded">
            <option value="Male">Male</option>
            <option value="Female">Female</option>
            <option value="Other">Other</option>
          </select>
        </div>
        <div>
          <label>Marital Status</label>
          <select formControlName="maritalStatus" class="w-full border p-2 rounded">
            <option value="Single">Single</option>
            <option value="Married">Married</option>
            <option value="Divorced">Divorced</option>
          </select>
        </div>
        <div>
          <label class="font-semibold text-gray-600 block uppercase">Blood Group</label>
          <select class="w-full border p-2 rounded outline-none focus:border-[#4a3f3f] bg-white">
            <option value="" disabled selected>Select Group</option>
            <option value="A+">A+</option>
            <option value="A-">A-</option>
            <option value="B+">B+</option>
            <option value="B-">B-</option>
            <option value="O+">O+</option>
            <option value="O-">O-</option>
            <option value="AB+">AB+</option>
            <option value="AB-">AB-</option>
          </select>
        </div>
      </div>

      <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
        <div><label class="font-bold">Mobile*</label> <input formControlName="mobile" class="w-full border p-2 rounded">
        </div>
        <div><label>Telephone</label> <input formControlName="telephone" class="w-full border p-2 rounded"></div>
      </div>

      <div class="grid grid-cols-1 md:grid-cols-3 gap-4 bg-blue-50/10 p-4 rounded border border-blue-100">
        <!-- <div class="space-y-1">
          <label class="font-semibold text-gray-600 block uppercase">User Type</label>
          <select formControlName="userType"
            class="w-full border p-2 rounded outline-none focus:border-[#4a3f3f] bg-white">
            <option value="" disabled selected>Select User Type</option>
            <option value="training">Training</option>
            <option value="payroll">Payroll</option>
            <option value="freelancing">Freelancing</option>
          </select>
        </div> -->
        <div>
          <label class="block text-sm font-semibold text-gray-700 mb-1">Department</label>
          <select formControlName="department"
            class="w-full border p-2 rounded focus:ring-2 focus:ring-blue-200 outline-none">
            <option [value]="''">-- Select Department --</option>
            <option *ngFor="let dept of departments" [value]="dept.id">{{ dept.name }}</option>
          </select>
        </div>

        <div>
          <label class="block text-sm font-semibold text-gray-700 mb-1">Designation</label>
          <select formControlName="designation"
            class="w-full border p-2 rounded focus:ring-2 focus:ring-blue-200 outline-none">
            <option [value]="''">-- Select Designation --</option>
            <option *ngFor="let des of designations" [value]="des.id">{{ des.name }}</option>
          </select>
        </div>
        <div><label>Functional Area</label> <input formControlName="functionalArea" class="w-full border p-2 rounded">
        </div>
        <!--change start-->
        <div>
          <label class="font-semibold text-gray-600 block uppercase">HOD</label>
          <select formControlName="hodId"
            class="w-full border p-2 rounded outline-none focus:border-[#4a3f3f] bg-white">
            <option [value]="null" disabled selected>Select HOD</option>
            <option *ngFor="let h of hods" [value]="h.id">{{ h.name }}</option>
          </select>
        </div>

        <div>
          <label class="font-semibold text-gray-600 block uppercase">Team</label>
          <select formControlName="teamId"
            class="w-full border p-2 rounded outline-none focus:border-[#4a3f3f] bg-white">
            <option [value]="null" disabled selected>Select Team</option>
            <option *ngFor="let t of teams" [value]="t.id">{{ t.teamName }}</option>
          </select>
        </div>
        <!--change end-->
      </div>

      <div class="grid grid-cols-1 md:grid-cols-3 gap-4 bg-blue-50/30 p-4 rounded">
        <div><label class="font-bold">PAN No*</label> <input formControlName="paN_No"
            class="w-full border p-2 rounded uppercase"></div>
        <div><label class="font-bold">Aadhaar No*</label> <input formControlName="aadhaarNo"
            class="w-full border p-2 rounded"></div>
      </div>

      <div class="border p-4 rounded-lg space-y-4">
        <h3 class="font-semibold text-lg">Job & Salary</h3>
        <div class="grid grid-cols-2 gap-4">
          <div>
            <label class="block font-medium">Joining Date</label>
            <input type="date" formControlName="dateOfJoining" class="w-full border rounded px-3 py-2" />
          </div>
          <div>
            <label class="block font-medium">CTC (Monthly)</label>
            <input type="number" name="ctc_Monthly" class="w-full border rounded px-3 py-2" />
          </div>
          <!-- <div>
            <label class="block font-medium">Salary Account No.</label>
            <input formControlName="salaryAccountNo" class="w-full border rounded px-3 py-2" />
          </div> -->
        </div>
      </div>

      <div formArrayName="experiences" class="space-y-6">
        <div *ngFor="let exp of experiences.controls; let i = index" [formGroupName]="i"
          class="grid grid-cols-1 md:grid-cols-3 gap-4 bg-blue-50/10 p-4 rounded border border-blue-100 relative">
          <button *ngIf="experiences.length > 1" type="button" (click)="removeExperience(i)"
            class="absolute -top-2 -right-2 bg-red-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs shadow hover:bg-red-600 transition">âœ•</button>
          <div class="md:col-span-3">
            <h3 class="text-lg font-bold text-gray-700 mb-2">Experience Details</h3>
          </div>
          <div class="space-y-1">
            <label class="font-semibold text-gray-600 block uppercase text-sm">Organization</label>
            <input type="text" formControlName="organizationName" placeholder="Company Name"
              class="w-full border p-2 rounded outline-none focus:border-[#4a3f3f] bg-white">
          </div>
          <div class="space-y-1">
            <label class="font-semibold text-gray-600 block uppercase text-sm">Designation</label>
            <input type="text" formControlName="designation" placeholder="e.g. Senior Manager"
              class="w-full border p-2 rounded outline-none focus:border-[#4a3f3f] bg-white">
          </div>
          <div class="space-y-1">
            <label class="font-semibold text-gray-600 block uppercase text-sm">Years of Experience</label>
            <input type="text" formControlName="totalYears" placeholder="e.g. 2.5 Years"
              class="w-full border p-2 rounded outline-none focus:border-[#4a3f3f] bg-white">
          </div>
          <div class="space-y-1">
            <label class="font-semibold text-gray-600 block uppercase text-sm">Annual Salary (CTC)</label>
            <input type="number" formControlName="annualSalary" placeholder="Enter Amount"
              class="w-full border p-2 rounded outline-none focus:border-[#4a3f3f] bg-white">
          </div>
               <div class="space-y-1">
            <label class="font-semibold text-gray-600 block uppercase text-sm">Date Of Exit</label>
            <input type="date" formControlName="exitDate" class="w-full border p-2 rounded outline-none focus:border-[#4a3f3f] bg-white">
          </div>
          <div class="md:col-span-3 flex items-center gap-2 pt-2 border-t mt-2">
            <input type="checkbox" formControlName="verification" id="verification-{{i}}"
              class="w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500">
            <label for="verification-{{i}}" class="text-sm font-semibold text-gray-700 uppercase">Verification
              Complete</label>
          </div>
        </div>
      </div>

      <div class="mt-4">
        <button type="button" (click)="addExperience()"
          class="bg-[#4a3f3f] text-white px-6 py-2 rounded font-bold uppercase text-xs shadow-md hover:opacity-90 transition">+
          Add Another Organization</button>
      </div>

     <div class="grid grid-cols-1 md:grid-cols-3 gap-4 bg-blue-50/10 p-4 rounded border border-blue-100">
  <div class="md:col-span-3">
    <h3 class="text-lg font-bold text-gray-700 mb-2">Bank Details</h3>
  </div>

  <!-- Row 1 -->
  <div class="space-y-1">
    <label class="font-semibold text-gray-600 block uppercase text-sm">Account Holder Name</label>
    <input type="text" name="accountHolderName" id="accountHolderName" placeholder="Enter Account Holder Name"
      class="w-full border p-2 rounded outline-none focus:border-[#4a3f3f]">
  </div>

  <div class="space-y-1">
    <label class="font-semibold text-gray-600 block uppercase text-sm">Bank Name</label>
    <input type="text" name="bankName" id="bankName" list="bankSuggestions" placeholder="Enter Bank Name"
      class="w-full border p-2 rounded outline-none focus:border-[#4a3f3f]">
    <datalist id="bankSuggestions">
      <option value="State Bank of India">
      <option value="HDFC Bank">
      <option value="ICICI Bank">
      <option value="Axis Bank">
    </datalist>
  </div>

  <div class="space-y-1">
    <label class="font-semibold text-gray-600 block uppercase text-sm">Branch Name</label>
    <input type="text" name="branchName" id="branchName" placeholder="Enter Branch Name"
      class="w-full border p-2 rounded outline-none focus:border-[#4a3f3f]">
  </div>

  <!-- Row 2 -->
  <div class="space-y-1">
    <label class="font-semibold text-gray-600 block uppercase text-sm">IFSC Code</label>
    <input type="text" name="ifscCode" id="ifscCode" placeholder="SBIN0001234"
      class="w-full border p-2 rounded outline-none focus:border-[#4a3f3f] uppercase">
  </div>

  <div class="space-y-1">
    <label class="font-semibold text-gray-600 block uppercase text-sm">Account Type</label>
    <select name="accountType" id="accountType"
      class="w-full border p-2 rounded outline-none focus:border-[#4a3f3f]">
      <option value="">Select Account Type</option>
      <option value="salary">Salary</option>
      <option value="personal account">Personal Account</option>
    </select>
  </div>
<div class="space-y-1">
  <label class="font-semibold text-gray-600 block uppercase text-[12px]">Account Number</label>
  <input 
    type="text" 
    name="accountNumber" 
    id="accountNumber" 
    value="ACC-2026-001" 
    placeholder="Enter Account Number"
    class="w-full border border-gray-300 p-2 rounded-sm outline-none focus:border-[#4a3f3f] text-[13px] shadow-sm bg-white"
  >
</div>
</div>

      <div class="space-y-6 border-t pt-4">
        <h3 class="font-bold text-green-600 underline">Corresponding Address</h3>
        <div class="bg-gray-50 p-4 rounded border">
          <div class="grid grid-cols-1 md:grid-cols-4 gap-3">
            <div><label>House/Flat No</label> <input formControlName="presHouseNo" class="w-full border p-1 rounded">
            </div>
            <div><label>Building/Society Name</label> <input formControlName="presBuilding"
                class="w-full border p-1 rounded"></div>
            <div><label>Floor No</label> <input formControlName="presFloor" class="w-full border p-1 rounded"></div>
            <div><label>Block/Wing</label> <input formControlName="presBlock" class="w-full border p-1 rounded"></div>
            <div><label>Street/Lane</label> <input formControlName="presStreet" class="w-full border p-1 rounded"></div>
            <div><label>Landmark</label> <input formControlName="presLandmark"
                class="w-full border p-1 rounded text-blue-600 font-medium"></div>
            <div><label>Area/Sector</label> <input formControlName="presArea" class="w-full border p-1 rounded"></div>
            <div><label>City</label> <input formControlName="presCity" class="w-full border p-1 rounded"></div>
            <div><label>District</label> <input formControlName="presDistrict" class="w-full border p-1 rounded"></div>
            <div><label>State</label> <input formControlName="presState" class="w-full border p-1 rounded"></div>
            <div><label>Pincode</label> <input formControlName="presPincode" class="w-full border p-1 rounded"></div>
            <div><label>Country</label> <input formControlName="presCountry" class="w-full border p-1 rounded"></div>
          </div>
        </div>

        <h3 class="font-bold text-green-600 underline">Parmanent Address</h3>
        <div class="bg-gray-50 p-4 rounded border">
          <div class="grid grid-cols-1 md:grid-cols-4 gap-3">
            <div><label>House/Flat No</label> <input formControlName="presHouseNo" class="w-full border p-1 rounded">
            </div>
            <div><label>Building/Society Name</label> <input formControlName="presBuilding"
                class="w-full border p-1 rounded"></div>
            <div><label>Floor No</label> <input formControlName="presFloor" class="w-full border p-1 rounded"></div>
            <div><label>Block/Wing</label> <input formControlName="presBlock" class="w-full border p-1 rounded"></div>
            <div><label>Street/Lane</label> <input formControlName="presStreet" class="w-full border p-1 rounded"></div>
            <div><label>Landmark</label> <input formControlName="presLandmark"
                class="w-full border p-1 rounded text-blue-600 font-medium"></div>
            <div><label>Area/Sector</label> <input formControlName="presArea" class="w-full border p-1 rounded"></div>
            <div><label>City</label> <input formControlName="presCity" class="w-full border p-1 rounded"></div>
            <div><label>District</label> <input formControlName="presDistrict" class="w-full border p-1 rounded"></div>
            <div><label>State</label> <input formControlName="presState" class="w-full border p-1 rounded"></div>
            <div><label>Pincode</label> <input formControlName="presPincode" class="w-full border p-1 rounded"></div>
            <div><label>Country</label> <input formControlName="presCountry" class="w-full border p-1 rounded"></div>
          </div>
        </div>
      </div>

      <div class="border-t pt-4">
        <div class="flex justify-between items-center mb-2">
          <h3 class="font-bold text-gray-600 mb-2 underline">Education</h3>
          <button type="button" (click)="addEducation()"
            class="bg-green-600 text-white px-3 py-1 rounded text-xs font-bold shadow-sm hover:bg-green-700 transition">+
            ADD MORE EDUCATION</button>
        </div>
        <div class="grid grid-cols-1 md:grid-cols-5 gap-4 mb-4 items-center">
          <input formControlName="tenthName" placeholder="10th" class="border p-2 rounded bg-gray-50" readonly>
          <input formControlName="tenthYear" placeholder="10th Year" class="border p-2 rounded">
          <input formControlName="tenthPercentage" placeholder="10th %" class="border p-2 rounded">
          <input type="file" (change)="onFileSelect($event,'tenthMarksheet')" class="border p-2 rounded">
        </div>
        <div class="grid grid-cols-1 md:grid-cols-5 gap-4 mb-4 items-center">
          <input formControlName="twelfthName" placeholder="12th" class="border p-2 rounded bg-gray-50" readonly>
          <input formControlName="twelfthYear" placeholder="12th Year" class="border p-2 rounded">
          <input formControlName="twelfthPercentage" placeholder="12th %" class="border p-2 rounded">
          <input type="file" (change)="onFileSelect($event,'twelfthMarksheet')" class="border p-2 rounded">
        </div>
        <div class="grid grid-cols-1 md:grid-cols-5 gap-4 mb-4 items-center">
          <input formControlName="graduationName" placeholder="Graduation" class="border p-2 rounded bg-gray-50"
            readonly>
          <input formControlName="graduationYear" placeholder="Graduation Year" class="border p-2 rounded">
          <input formControlName="graduationPercentage" placeholder="Graduation %" class="border p-2 rounded">
          <input type="file" (change)="onFileSelect($event,'graduationMarksheet')" class="border p-2 rounded">
        </div>
        <div class="grid grid-cols-1 md:grid-cols-5 gap-4 mb-6 items-center">
          <input formControlName="postGraduationName" placeholder="Post Graduation"
            class="border p-2 rounded bg-gray-50" readonly>
          <input formControlName="postGraduationYear" placeholder="PG Year" class="border p-2 rounded">
          <input formControlName="postGraduationPercentage" placeholder="PG %" class="border p-2 rounded">
          <input type="file" (change)="onFileSelect($event,'postGraduationMarksheet')" class="border p-2 rounded">
        </div>
        <div formArrayName="educations">
          <div *ngFor="let edu of educations.controls; let i = index" [formGroupName]="i"
            class="grid grid-cols-1 md:grid-cols-5 gap-4 mb-4 items-center">
            <input formControlName="educationName" placeholder="Other Education Name" class="border p-2 rounded">
            <input formControlName="year" placeholder="Passing Year" class="border p-2 rounded">
            <input formControlName="percentage" placeholder="Percentage %" class="border p-2 rounded">
            <input type="file" (change)="onFileSelect($event, 'marksheet', i)" class="border p-2 rounded">
            <div class="flex justify-between items-center">
              <button type="button" (click)="removeEducation(i)"
                class="text-red-500 text-xs font-bold hover:underline">Remove</button>
            </div>
          </div>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mt-8">
          <div>
            <label class="text-sm font-semibold">Profile Picture</label>
            <input type="file" (change)="onFileSelect($event,'profilePicture')" class="w-full border p-2 rounded">
          </div>
          <!-- <div>
            <label class="text-sm font-semibold">Signature</label>
            <input type="file" (change)="onFileSelect($event,'signature')" class="w-full border p-2 rounded">
          </div>
          <div>
            <label class="text-sm font-semibold">Profile Select</label>
            <input formControlName="profileSelect" class="w-full border p-2 rounded">
          </div> -->
        </div>
      </div>

      <div class="grid grid-cols-1 md:grid-cols-3 gap-4 border-t pt-4">
        <div><label>Emergency Contact Name</label> <input formControlName="emergencyName"
            class="w-full border p-2 rounded"></div>
        <div>
          <label class="text-sm font-semibold">Relation</label>
          <input list="relationsList" formControlName="emergencyRelationship" placeholder="Select or Type Relation"
            class="w-full border p-2 rounded bg-white">
          <datalist id="relationsList">
            <option value="Father">
            <option value="Mother">
            <option value="Spouse">
            <option value="Brother">
            <option value="Sister">
            <option value="Son">
            <option value="Daughter">
            <option value="Friend">
            <option value="Colleague">
          </datalist>
        </div>
        <div><label>Emergency Mobile</label> <input formControlName="emergencyContactNo"
            class="w-full border p-2 rounded"></div>
      </div>

      <div class="border-t pt-6 mt-8">
        <h3 class="text-lg font-bold text-gray-700 mb-4 uppercase tracking-wider border-l-4 border-blue-600 pl-3">
          Documentation Upload</h3>
        <div
          class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 bg-gray-50 p-6 rounded-lg border border-gray-200">
          <div class="flex flex-col space-y-2">
            <label class="font-bold text-gray-600 uppercase text-xs">Offer Letter</label>
            <input type="file" (change)="onFileSelect($event, 'offerLetter')"
              class="border p-2 rounded bg-white text-xs file:bg-blue-50 file:border-0 file:rounded file:px-2 file:py-1 file:text-blue-700 hover:file:bg-blue-100">
          </div>
          <div class="flex flex-col space-y-2">
            <label class="font-bold text-gray-600 uppercase text-xs">Appointment Letter</label>
            <input type="file" (change)="onFileSelect($event, 'appointmentLetter')"
              class="border p-2 rounded bg-white text-xs file:bg-blue-50 file:border-0 file:rounded file:px-2 file:py-1 file:text-blue-700 hover:file:bg-blue-100">
          </div>
          <div class="flex flex-col space-y-2">
            <label class="font-bold text-gray-600 uppercase text-xs">Invitation Letter</label>
            <input type="file" (change)="onFileSelect($event, 'invitationLetter')"
              class="border p-2 rounded bg-white text-xs file:bg-blue-50 file:border-0 file:rounded file:px-2 file:py-1 file:text-blue-700 hover:file:bg-blue-100">
          </div>
          <div class="flex flex-col space-y-2">
            <label class="font-bold text-gray-600 uppercase text-xs">Relieving Letter</label>
            <input type="file" (change)="onFileSelect($event, 'relievingLetter')"
              class="border p-2 rounded bg-white text-xs file:bg-blue-50 file:border-0 file:rounded file:px-2 file:py-1 file:text-blue-700 hover:file:bg-blue-100">
          </div>
          <div class="flex flex-col space-y-2">
            <label class="font-bold text-gray-600 uppercase text-xs">Full and Final Letter</label>
            <input type="file" (change)="onFileSelect($event, 'fullAndFinalLetter')"
              class="border p-2 rounded bg-white text-xs file:bg-blue-50 file:border-0 file:rounded file:px-2 file:py-1 file:text-blue-700 hover:file:bg-blue-100">
          </div>
        </div>
      </div>

    </div>

    <div class="flex justify-end gap-3 pt-6 border-t">

      <button type="button" (click)="onCancel()"
        class="px-6 py-2 border rounded hover:bg-gray-100 transition">Cancel</button>
      <button type="submit" [disabled]="userForm.invalid"
        class="px-10 py-2 bg-blue-600 text-white rounded font-bold hover:bg-blue-700 disabled:bg-gray-300 transition-all shadow-md">
        {{ isEditMode ? 'Update' : 'Save' }} Details
      </button>
    </div>
  </form>
</div>