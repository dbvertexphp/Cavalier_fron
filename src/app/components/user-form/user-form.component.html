<div class="max-w-6xl mx-auto p-6 bg-white rounded-xl shadow-lg border border-gray-100 overflow-y-auto max-h-[85vh]">
  <h2 class="text-2xl font-bold text-blue-700 mb-6 border-b pb-4">
    {{ isBranchForm ? 'Cavalier Branch Registration' : 'Cavalier Employee Registration' }}
  </h2>
  
  <form [formGroup]="userForm" (ngSubmit)="onSubmit()" class="space-y-6 text-sm">
    
    <div *ngIf="isBranchForm" class="space-y-6">
      <div class="grid grid-cols-1 md:grid-cols-2 gap-4 bg-gray-50 p-4 rounded">
        <div><label class="font-bold">Company Name*</label> <input formControlName="companyName" class="w-full border p-2 rounded"></div>
        <div><label>Company Alias</label> <input formControlName="companyAlias" class="w-full border p-2 rounded"></div>
      </div>

      <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
        <div><label class="font-bold">Branch Name*</label> <input formControlName="branchName" class="w-full border p-2 rounded"></div>
        <div><label class="font-bold">Branch Code*</label> <input formControlName="branchCode" class="w-full border p-2 rounded uppercase"></div>
        <div><label class="font-bold">Email*</label> <input formControlName="email" class="w-full border p-2 rounded"></div>
      </div>

      <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
        <div><label>City*</label> <input formControlName="city" class="w-full border p-2 rounded"></div>
        <div><label>State*</label> <input formControlName="state" class="w-full border p-2 rounded"></div>
        <div><label>Postal Code*</label> <input formControlName="postalCode" class="w-full border p-2 rounded"></div>
        <div><label>Contact No*</label> <input formControlName="contactNo" class="w-full border p-2 rounded"></div>
      </div>

      <div class="grid grid-cols-1 md:grid-cols-2 gap-4 bg-blue-50/30 p-4 rounded">
        <div><label class="font-bold">GST Category*</label> 
          <select formControlName="gstCategory" class="w-full border p-2 rounded">
            <option value="Regular">Regular</option>
            <option value="Composition">Composition</option>
          </select>
        </div>
        <div><label class="font-bold">GSTIN*</label> <input formControlName="gstin" class="w-full border p-2 rounded uppercase"></div>
      </div>

      <div><label>Full Address*</label> <textarea formControlName="address" class="w-full border p-2 rounded h-16"></textarea></div>
    </div>

    <div *ngIf="!isBranchForm" class="space-y-6">
      <div class="grid grid-cols-1 md:grid-cols-4 gap-4 bg-gray-50 p-4 rounded">
        <!-- <div><label class="font-bold">Emp Code*</label> <input formControlName="empCode" class="w-full border p-2 rounded"></div> -->
        <div><label class="font-bold">First Name*</label> <input formControlName="firstName" class="w-full border p-2 rounded"></div>
        <div><label>Middle Name</label> <input formControlName="middleName" class="w-full border p-2 rounded"></div>
        <div><label class="font-bold">Last Name*</label> <input formControlName="lastName" class="w-full border p-2 rounded"></div>
        <div>
  <label class="font-semibold text-gray-600 block uppercase">Type of Disability</label>
  <select class="w-full border p-2 rounded outline-none focus:border-[#4a3f3f] bg-white">
    <option value="" disabled selected>Select Option</option>
    <option value="Yes">Yes</option>
    <option value="No">No</option>
  </select>
</div>
      </div>

      <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
        <div><label>DOB*</label> <input type="date" formControlName="dob" class="w-full border p-2 rounded"></div>
        
        <div>
          <label>Gender</label>
          <select formControlName="gender" class="w-full border p-2 rounded">
            <option value="Male">Male</option>
            <option value="Female">Female</option>
            <option value="Other">Other</option>
          </select>
        </div>
        <div>
          <label>Marital Status</label>
          <select formControlName="maritalStatus" class="w-full border p-2 rounded">
            <option value="Single">Single</option>
            <option value="Married">Married</option>
            <option value="Divorced">Divorced</option>
          </select>
        </div>

        <div>
  <label class="font-semibold text-gray-600 block uppercase">Blood Group</label>
  <select  class="w-full border p-2 rounded outline-none focus:border-[#4a3f3f] bg-white">
    <option value="" disabled selected>Select Group</option>
    <option value="A+">A+</option>
    <option value="A-">A-</option>
    <option value="B+">B+</option>
    <option value="B-">B-</option>
    <option value="O+">O+</option>
    <option value="O-">O-</option>
    <option value="AB+">AB+</option>
    <option value="AB-">AB-</option>
  </select>
</div>
      </div>

      <div class="grid grid-cols-1 md:grid-cols-3 gap-4 bg-blue-50/10 p-4 rounded border border-blue-100">
        <div>
          <label class="block text-sm font-semibold text-gray-700 mb-1">Department</label> 
          <select formControlName="department" class="w-full border p-2 rounded focus:ring-2 focus:ring-blue-200 outline-none">
            <option [value]="''">-- Select Department --</option>
            <option *ngFor="let dept of departments" [value]="dept.id">{{ dept.name }}</option>
          </select>
        </div>

        <div>
          <label class="block text-sm font-semibold text-gray-700 mb-1">Designation</label> 
          <select formControlName="designation" class="w-full border p-2 rounded focus:ring-2 focus:ring-blue-200 outline-none">
            <option [value]="''">-- Select Designation --</option>
            <option *ngFor="let des of designations" [value]="des.id">{{ des.name }}</option>
          </select>
        </div>

        <div><label>Functional Area</label> <input formControlName="functionalArea" class="w-full border p-2 rounded"></div>
        
        <div class="space-y-1">
          <label class="font-semibold text-gray-600 block uppercase">User Type</label>
          <select formControlName="userType" class="w-full border p-2 rounded outline-none focus:border-[#4a3f3f] bg-white">
            <option value="" disabled selected>Select User Type</option>
            <option value="training">Training</option>
            <option value="payroll">Payroll</option>
            <option value="freelancing">Freelancing</option>
          </select>
        </div> 

       <!-- <div class="mb-4">
  <label class="block text-sm font-semibold text-gray-700 mb-1">
    Branch
  </label>

  <select formControlName="branchId"
    class="w-full border p-2 rounded focus:ring-2 focus:ring-blue-200 outline-none">

    <option [ngValue]="null" disabled>
      -- Select Branch --
    </option>

    <option *ngFor="let branch of branches" [value]="branch.id">
      {{ branch.branchName }}
    </option>

  </select>

  <span class="text-red-500 text-xs"
    *ngIf="userForm.get('branchId')?.touched && userForm.get('branchId')?.invalid">
    Branch is required
  </span>
</div> -->


        <!-- <div class="mb-4">
          <label class="block text-sm font-semibold text-gray-700 mb-1">Role</label>
          <select formControlName="roleId" 
            class="w-full border p-2 rounded focus:ring-2 focus:ring-blue-200 outline-none">
            <option [value]="null" disabled>-- Select Role --</option>
            <option *ngFor="let role of roles" [value]="role.id">
              {{ role.name }}
            </option>
          </select>
        </div> -->

        <!-- <div><label>HOD</label> <input formControlName="licenceType" class="w-full border p-2 rounded"></div> -->
          <div class="space-y-1">
          <label class="font-semibold text-gray-600 block uppercase">HOD</label>
          <select  class="w-full border p-2 rounded outline-none focus:border-[#4a3f3f] bg-white">
            <option value="" disabled selected>Select</option>
            <option value="dropdown">DROP1</option>
            <option value="dropdown">DROP2</option>
            <option value="dropdown">DROP3</option>
          </select>
        </div>
        

        <!-- <div class="flex flex-col gap-1">
    <label class="font-bold text-gray-600">HOD </label>
    <select class="border border-gray-300 p-1 bg-white outline-none w-full">
      <option value="">HOD</option>
      <option value="DROP1">Drop1</option>
      <option value="DROP2">Drop2</option>
      <option value="DRP3">Drop3</option>
    </select>
  </div> -->
      </div>

      <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
        <div><label>Email (Username)*</label> <input formControlName="email" class="w-full border p-2 rounded"></div>
        <div><label>Mobile*</label> <input formControlName="mobile" class="w-full border p-2 rounded"></div>
        <div><label>Telephone</label> <input formControlName="telephone" class="w-full border p-2 rounded"></div>
        <div>
    <!-- <label>Password*</label> -->

    <!-- <div class="flex gap-2">
      <input
        [type]="showPassword ? 'text' : 'password'"
        formControlName="password"
        class="w-full border p-2 rounded"
        placeholder="Enter or generate password">

      <button
        type="button"
        (click)="generatePassword()"
        class="bg-blue-600 text-white px-3 rounded hover:bg-blue-700">
        Generate
      </button>
    </div> -->

    <!-- SHOW / HIDE -->
    <!-- <div class="text-xs mt-1 cursor-pointer text-blue-600"
         (click)="showPassword = !showPassword">
      {{ showPassword ? 'Hide' : 'Show' }} password
    </div> -->
  </div>
        
      </div>

      <div class="grid grid-cols-1 md:grid-cols-3 gap-4 bg-blue-50/30 p-4 rounded">
        <div><label class="font-bold">PAN No*</label> <input formControlName="paN_No" class="w-full border p-2 rounded uppercase"></div>
        <div><label class="font-bold">Aadhaar No*</label> <input formControlName="aadhaarNo" class="w-full border p-2 rounded"></div>
         <div><label class="font-bold">PAN No of Father/Husband*</label> <input formControlName="paN_No" class="w-full border p-2 rounded uppercase"></div>
       
      </div>
      
      
 <div class="border p-4 rounded-lg space-y-4">
      <h3 class="font-semibold text-lg">Job & Salary</h3>

      <div class="grid grid-cols-2 gap-4">
       
       

        <div>
          <label class="block font-medium">Joining Date</label>
          <input type="date" formControlName="dateOfJoining" class="w-full border rounded px-3 py-2"/>
        </div>

        <div>
          <label class="block font-medium">CTC (Monthly)</label>
          <input type="number" name="ctc_Monthly" class="w-full border rounded px-3 py-2"/>
        </div>

        <div>
          <label class="block font-medium">Salary Account No.</label>
          <input formControlName="salaryAccountNo"  class="w-full border rounded px-3 py-2"/>
        </div>
      </div>
    </div>
<!-- Bank details  -->
 <div class="grid grid-cols-1 md:grid-cols-3 gap-4 bg-blue-50/10 p-4 rounded border border-blue-100">
  
  <div class="md:col-span-3">
    <h3 class="text-lg font-bold text-gray-700 mb-2">Bank Details</h3>
  </div>

  <div class="space-y-1">
    <label class="font-semibold text-gray-600 block uppercase text-sm">Account Type</label>
    <select name="accountType" id="accountType" class="w-full border p-2 rounded outline-none focus:border-[#4a3f3f] bg-white">
      <option value="" disabled selected>Select Account Type</option>
      <option value="salary">Salary Account</option>
      <option value="personal">Personal Account</option>
    </select>
  </div>

  <div class="space-y-1">
    <label class="font-semibold text-gray-600 block uppercase text-sm">User Type</label>
    <select name="userRole" id="userRole" class="w-full border p-2 rounded outline-none focus:border-[#4a3f3f] bg-white">
      <option value="" disabled selected>Select Role</option>
      <option value="training">Training</option>
      <option value="payroll">Payroll</option>
      <option value="Freelancing">FreeLancing</option>
    </select>
  </div>

  <div class="space-y-1">
    <label class="font-semibold text-gray-600 block uppercase text-sm">Bank Name</label>
    <input type="text" name="bankName" id="bankName" list="bankSuggestions" placeholder="Enter Bank Name" 
           class="w-full border p-2 rounded outline-none focus:border-[#4a3f3f]">
    <datalist id="bankSuggestions">
      <option value="State Bank of India">
      <option value="HDFC Bank">
      <option value="ICICI Bank">
      <option value="Axis Bank">
    </datalist>
  </div>

  <div class="space-y-1">
    <label class="font-semibold text-gray-600 block uppercase text-sm">Branch Name</label>
    <input type="text" name="branchName" id="branchName" placeholder="Enter Branch" 
           class="w-full border p-2 rounded outline-none focus:border-[#4a3f3f]">
  </div>

  <div class="space-y-1">
    <label class="font-semibold text-gray-600 block uppercase text-sm">IFSC Code</label>
    <input type="text" name="ifscCode" id="ifscCode" placeholder="SBIN0001234" 
           class="w-full border p-2 rounded outline-none focus:border-[#4a3f3f] uppercase">
  </div>

</div>
<!-- bank details end  -->



      <div class="space-y-6 border-t pt-4">
        <h3 class="font-bold text-blue-600 underline">Residential & Office Address Details</h3>
        
        <div class="bg-gray-50 p-4 rounded border">
          <p class="font-bold mb-3 text-gray-700 italic text-[12px]">Present Residential Address:</p>
          <div class="grid grid-cols-1 md:grid-cols-4 gap-3">
            <div><label>House/Flat No</label> <input formControlName="presHouseNo" class="w-full border p-1 rounded"></div>
            <div><label>Building/Society Name</label> <input formControlName="presBuilding" class="w-full border p-1 rounded"></div>
            <div><label>Floor No</label> <input formControlName="presFloor" class="w-full border p-1 rounded"></div>
            <div><label>Block/Wing</label> <input formControlName="presBlock" class="w-full border p-1 rounded"></div>
            <div><label>Street/Lane</label> <input formControlName="presStreet" class="w-full border p-1 rounded"></div>
            <div><label>Landmark</label> <input formControlName="presLandmark" class="w-full border p-1 rounded text-blue-600 font-medium"></div>
            <div><label>Area/Sector</label> <input formControlName="presArea" class="w-full border p-1 rounded"></div>
            <div><label>City</label> <input formControlName="presCity" class="w-full border p-1 rounded"></div>
            <div><label>District</label> <input formControlName="presDistrict" class="w-full border p-1 rounded"></div>
            <div><label>State</label> <input formControlName="presState" class="w-full border p-1 rounded"></div>
            <div><label>Pincode</label> <input formControlName="presPincode" class="w-full border p-1 rounded"></div>
            <div><label>Country</label> <input formControlName="presCountry" class="w-full border p-1 rounded"></div>
          </div>
        </div>




        <div class="bg-blue-50/20 p-4 rounded border">
          <p class="font-bold mb-3 text-gray-700 italic text-[12px]">Permanent Residential Address:</p>
          <div class="grid grid-cols-1 md:grid-cols-4 gap-3">
            <div><label>House/Flat No</label> <input formControlName="permHouseNo" class="w-full border p-1 rounded"></div>
            <div><label>Building/Society Name</label> <input formControlName="permBuilding" class="w-full border p-1 rounded"></div>
            <div><label>Floor No</label> <input formControlName="permFloor" class="w-full border p-1 rounded"></div>
            <div><label>Block/Wing</label> <input formControlName="permBlock" class="w-full border p-1 rounded"></div>
            <div><label>Street/Lane</label> <input formControlName="permStreet" class="w-full border p-1 rounded"></div>
            <div><label>Landmark</label> <input formControlName="permLandmark" class="w-full border p-1 rounded text-blue-600 font-medium"></div>
            <div><label>Area/Sector</label> <input formControlName="permArea" class="w-full border p-1 rounded"></div>
            <div><label>City</label> <input formControlName="permCity" class="w-full border p-1 rounded"></div>
            <div><label>District</label> <input formControlName="permDistrict" class="w-full border p-1 rounded"></div>
            <div><label>State</label> <input formControlName="permState" class="w-full border p-1 rounded"></div>
            <div><label>Pincode</label> <input formControlName="permPincode" class="w-full border p-1 rounded"></div>
            <div><label>Country</label> <input formControlName="permCountry" class="w-full border p-1 rounded"></div>
          </div>
        </div>
      </div>
<div class="border-t pt-4">
  <div class="flex justify-between items-center mb-2">
    <h3 class="font-bold text-gray-600 mb-2 underline">
      Education & Profile Media
    </h3>
    <button type="button" (click)="addEducation()" class="bg-blue-600 text-white px-3 py-1 rounded text-xs font-bold shadow-sm hover:bg-blue-700 transition">
      + ADD MORE EDUCATION
    </button>
  </div>

  <div class="grid grid-cols-1 md:grid-cols-5 gap-4 mb-4 items-center">
    <input formControlName="tenthName" placeholder="10th" class="border p-2 rounded bg-gray-50" readonly>
    <input formControlName="tenthYear" placeholder="10th Year" class="border p-2 rounded">
    <input formControlName="tenthPercentage" placeholder="10th %" class="border p-2 rounded">
    <input type="file" (change)="onFileSelect($event,'tenthMarksheet')" class="border p-2 rounded">
    <!-- <span class="text-xs text-gray-400">10th Marksheet</span> -->
  </div>

  <div class="grid grid-cols-1 md:grid-cols-5 gap-4 mb-4 items-center">
    <input formControlName="twelfthName" placeholder="12th" class="border p-2 rounded bg-gray-50" readonly>
    <input formControlName="twelfthYear" placeholder="12th Year" class="border p-2 rounded">
    <input formControlName="twelfthPercentage" placeholder="12th %" class="border p-2 rounded">
    <input type="file" (change)="onFileSelect($event,'twelfthMarksheet')" class="border p-2 rounded">
    <!-- <span class="text-xs text-gray-400">12th Marksheet</span> -->
  </div>

  <div class="grid grid-cols-1 md:grid-cols-5 gap-4 mb-4 items-center">
    <input formControlName="graduationName" placeholder="Graduation" class="border p-2 rounded bg-gray-50" readonly>
    <input formControlName="graduationYear" placeholder="Graduation Year" class="border p-2 rounded">
    <input formControlName="graduationPercentage" placeholder="Graduation %" class="border p-2 rounded">
    <input type="file" (change)="onFileSelect($event,'graduationMarksheet')" class="border p-2 rounded">
    <!-- <span class="text-xs text-gray-400">Graduation Marksheet</span> -->
  </div>

  <div class="grid grid-cols-1 md:grid-cols-5 gap-4 mb-6 items-center">
    <input formControlName="postGraduationName" placeholder="Post Graduation" class="border p-2 rounded bg-gray-50" readonly>
    <input formControlName="postGraduationYear" placeholder="PG Year" class="border p-2 rounded">
    <input formControlName="postGraduationPercentage" placeholder="PG %" class="border p-2 rounded">
    <input type="file" (change)="onFileSelect($event,'postGraduationMarksheet')" class="border p-2 rounded">
    <!-- <span class="text-xs text-gray-400">PG Marksheet</span> -->
  </div>

  <div formArrayName="educations">
    <div *ngFor="let edu of educations.controls; let i = index" [formGroupName]="i" 
         class="grid grid-cols-1 md:grid-cols-5 gap-4 mb-4 items-center">
      
      <input formControlName="educationName" placeholder="Other Education Name" class="border p-2 rounded">
      <input formControlName="year" placeholder="Passing Year" class="border p-2 rounded">
      <input formControlName="percentage" placeholder="Percentage %" class="border p-2 rounded">
      <input type="file" (change)="onFileSelect($event, 'marksheet', i)" class="border p-2 rounded">
      
      <div class="flex justify-between items-center">
        <!-- <span class="text-xs text-gray-400 italic">Other Marksheet</span> -->
        <button type="button" (click)="removeEducation(i)" class="text-red-500 text-xs font-bold hover:underline">
          Remove
        </button>
      </div>
    </div>
  </div>

  <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mt-8">
    <div>
      <label class="text-sm font-semibold">Profile Picture</label>
      <input type="file" (change)="onFileSelect($event,'profilePicture')" class="w-full border p-2 rounded">
    </div>
    <div>
      <label class="text-sm font-semibold">Signature</label>
      <input type="file" (change)="onFileSelect($event,'signature')" class="w-full border p-2 rounded">
    </div>
    <div>
      <label class="text-sm font-semibold">Profile Select</label>
      <input formControlName="profileSelect" class="w-full border p-2 rounded">
    </div>
  </div>
</div>


      <div class="grid grid-cols-1 md:grid-cols-3 gap-4 border-t pt-4">
        <!-- <div><label>Report To (ID)</label> <input type="number" formControlName="reportTo" class="w-full border p-2 rounded"></div> -->
        <div><label>Emergency Contact Name</label> <input formControlName="emergencyName" class="w-full border p-2 rounded"></div>
        
        <div><label>Relation</label> <input formControlName="emergencyRelationship" class="w-full border p-2 rounded"></div>
        <div><label>Emergency Mobile</label> <input formControlName="emergencyContactNo" class="w-full border p-2 rounded"></div>
      </div>
<!-- 
      <div class="bg-gray-50 p-4 rounded border border-gray-200">
        <h3 class="font-bold text-gray-600 mb-3">System Permissions & Status</h3>
        <div class="flex flex-wrap gap-6">
          <label class="flex items-center gap-2 cursor-pointer"><input type="checkbox" formControlName="mfaRegistration" class="w-4 h-4"> MFA Registration</label>
          <label class="flex items-center gap-2 cursor-pointer"><input type="checkbox" formControlName="fieldVisit" class="w-4 h-4"> Field Visit Allowed</label>
          <label class="flex items-center gap-2 cursor-pointer"><input type="checkbox" formControlName="alwaysBccmyself" class="w-4 h-4"> Always BCC Myself</label>
          <label class="flex items-center gap-2 cursor-pointer"><input type="checkbox" formControlName="invitationLetter" class="w-4 h-4"> Invitation Letter</label>
          <label class="flex items-center gap-2 cursor-pointer"><input type="checkbox" formControlName="simIssued" class="w-4 h-4"> SIM Issued</label>
          <label class="flex items-center gap-2 cursor-pointer"><input type="checkbox" formControlName="status" class="w-4 h-4 text-green-600"> Active Status</label>
        </div>
      </div> -->
      <!-- <div class="bg-gray-50 p-4 rounded border border-gray-200">
  <h3 class="font-bold text-gray-600 mb-3">System Permissions</h3>

  <div class="flex flex-wrap gap-6">
    <label
      *ngFor="let p of permissions"
      class="flex items-center gap-2 cursor-pointer"
    >
      <input
        type="checkbox"
        class="w-4 h-4"
        (change)="onPermissionToggle(p, $event)"
      />
      {{ p.name }}
    </label>
  </div>
</div> -->

    </div>

    <div class="flex justify-end gap-3 pt-6 border-t">
      <button type="button" (click)="onCancel()" class="px-6 py-2 border rounded hover:bg-gray-100 transition">Cancel</button>
      <button type="submit" [disabled]="userForm.invalid" 
        class="px-10 py-2 bg-blue-600 text-white rounded font-bold hover:bg-blue-700 disabled:bg-gray-300 transition-all shadow-md">
        {{ isEditMode ? 'Update' : 'Save' }} Details
      </button>
    </div>
  </form>
</div>